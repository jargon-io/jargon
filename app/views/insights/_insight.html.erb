<%# locals: (insight:, expanded: true, show_source: false) %>

<div id="<%= dom_id(insight) %>" class="py-2">
  <h2 class="font-medium">
    <%= link_to insight.title, insight, class: "text-blue-600 hover:text-blue-800" %>
  </h2>

  <% if show_source %>
    <p class="text-xs text-gray-500 mt-1">
      From: <%= link_to insight.article.title, insight.article, class: "hover:text-gray-700" %>
    </p>
  <% end %>

  <% if expanded %>
    <% if insight.body.present? %>
      <p class="text-gray-700 mt-2"><%= insight.body %></p>
    <% end %>

    <% if insight.snippet.present? %>
      <blockquote class="mt-3 pl-4 border-l-2 border-gray-300 text-gray-500 italic text-sm">
        <%= insight.snippet %>
      </blockquote>
    <% end %>

    <% if insight.research_threads.any? %>
      <div class="mt-3">
        <ul class="space-y-1">
          <% insight.research_threads.each do |thread| %>
            <li class="text-sm">
              <%= button_to research_threads_path(research_thread_id: thread.id),
                  method: :post,
                  class: "cursor-pointer text-gray-600 hover:text-blue-600 text-left" do %>
                â†’ <%= thread.query %>
              <% end %>
            </li>
          <% end %>
        </ul>
      </div>
    <% end %>
  <% end %>
</div>

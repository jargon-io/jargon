<% content_for(:title) { "#{@insight.title} | Jargon" } %>
<div class="w-full max-w-2xl mx-auto space-y-4">
  <h1 class="text-3xl font-bold text-heading"><%= @insight.title %></h1>

  <% if @insight.body.present? %>
    <p class="text-lg text-body leading-relaxed"><%= render_content(@insight.body, current_item: @insight) %></p>
  <% end %>

  <%= render "shared/snippet", text: @insight.snippet, current_item: @insight %>

  <% if @insight.parent? && @source_articles.present? %>
    <%= render "shared/section_heading", title: "Sources" %>
    <div class="space-y-4" data-controller="expandable-list">
      <% @source_articles.each do |article| %>
        <div data-expandable-list-target="item">
          <%= render "articles/article", article: article %>
        </div>
      <% end %>
      <%= render "shared/expandable_toggle" %>
    </div>
  <% elsif @insight.article.present? %>
    <%= render partial: "articles/article", locals: { article: @insight.article } %>
  <% end %>

  <%= render "shared/section_heading", title: "Explore", id: "insights" %>

  <%= render "searches/explore", source: @insight, searches: @insight.searches %>

  <% sibling_insights = @insight.sibling_insights %>
  <% if sibling_insights.any? %>
    <%= render "shared/section_heading", title: "Siblings" %>
    <div class="space-y-4" data-controller="expandable-list">
      <% sibling_insights.each do |item| %>
        <div data-expandable-list-target="item">
          <%= render "shared/item", item: item, suppress_source: true %>
        </div>
      <% end %>
      <%= render "shared/expandable_toggle" %>
    </div>
  <% end %>

  <% if @similar_items.any? %>
    <%= render "shared/section_heading", title: "Related" %>
    <div class="space-y-4" data-controller="expandable-list">
      <% @similar_items.each do |item| %>
        <div data-expandable-list-target="item">
          <%= render "shared/item", item: item %>
        </div>
      <% end %>
      <%= render "shared/expandable_toggle" %>
    </div>
  <% end %>
</div>

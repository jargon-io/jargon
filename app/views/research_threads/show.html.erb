<%= turbo_stream_from "research_thread_#{@thread.id}" %>

<div class="w-full max-w-2xl mx-auto space-y-4">
  <div>
    <%= render partial: "insights/insight", locals: { insight: @thread.insight } %>
  </div>

  <div class="w-full text-left flex items-start gap-3 p-3 border-2 border-blue-300 bg-blue-50 rounded-lg text-lg">
    <span class="text-blue-500">â†’</span>
    <span class="text-gray-700 flex-1"><%= @thread.query %></span>
  </div>

  <h2 id="articles" class="text-2xl font-semibold pt-6 pb-2">Articles</h2>

  <% if @thread_articles.any? %>
    <% @thread_articles.each do |ta| %>
      <%= render partial: "articles/article", locals: { article: ta.article } %>
    <% end %>
  <% else %>
    <div id="thread_articles_loading">
      <div class="animate-pulse space-y-3">
        <div class="h-5 bg-gray-200 rounded w-2/3"></div>
        <div class="h-4 bg-gray-100 rounded w-full"></div>
      </div>
      <p class="text-sm text-gray-400 mt-2">Searching for articles...</p>
    </div>
  <% end %>

  <h2 class="text-2xl font-semibold pt-6 pb-2">Related</h2>
  <%= render partial: "shared/item", collection: @related_items, as: :item %>
</div>
